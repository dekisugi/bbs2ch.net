#============================================================================================================
#
#	拡張機能 - !をアホにします
#	0ch_watamu.pl
#	by 出来杉2.0 ★
#	---------------------------------------------------------------------------
#	メール欄に「!watamu」と書くと、本文の「!」が「&#33;」になりまーす
#	---------------------------------------------------------------------------
#	2008.07.06 start
#	2009.09.05 実行モードを16からさん！へ
#
#============================================================================================================
package ZPL_watamu;

#------------------------------------------------------------------------------------------------------------
#
#	コンストラクタ
#	-------------------------------------------------------------------------------------
#	@param	なし
#	@return	オブジェクト
#
#------------------------------------------------------------------------------------------------------------
sub new
{
	my $this = shift;
	my $obj={};
	bless($obj,$this);
	return $obj;
}

#------------------------------------------------------------------------------------------------------------
#
#	拡張機能名称取得
#	-------------------------------------------------------------------------------------
#	@param	なし
#	@return	名称文字列
#
#------------------------------------------------------------------------------------------------------------
sub getName
{
	my	$this = shift;
	return '!をアホにします';
}

#------------------------------------------------------------------------------------------------------------
#
#	拡張機能説明取得
#	-------------------------------------------------------------------------------------
#	@param	なし
#	@return	説明文字列
#
#------------------------------------------------------------------------------------------------------------
sub getExplanation
{
	my	$this = shift;
	return 'メール欄に!watamuで本文の!が&amp;#33;になる';
}

#------------------------------------------------------------------------------------------------------------
#
#	拡張機能タイプ取得
#	-------------------------------------------------------------------------------------
#	@param	なし
#	@return	拡張機能タイプ(スレ立て:1,レス:2,read:4,index:8)
#
#------------------------------------------------------------------------------------------------------------
sub getType
{
	my	$this = shift;
	return ( 1 | 2 );
}

#------------------------------------------------------------------------------------------------------------
#
#	拡張機能実行インタフェイス
#	-------------------------------------------------------------------------------------
#	@param	$sys	MELKOR
#	@param	$form	SAMWISE
#	@return	正常終了の場合は0
#
#------------------------------------------------------------------------------------------------------------
sub execute
{
	my $this = shift;
	my ($sys,$form) = @_;
	
	if (index($form->Get('mail'), "!watamu") >= 0) {
		(my $mail = $form->Get('mail')) =~ s/!watamu//;
		(my $mes = $form->Get('MESSAGE')) =~ s/!/&#33;/g;
		$form->Set('mail',$mail);
		$form->Set('MESSAGE',$mes);
	}
	
	return 0;
}

#============================================================================================================
#	Module END
#============================================================================================================
1;
